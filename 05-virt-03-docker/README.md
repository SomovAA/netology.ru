# Домашнее задание к занятию "5.3. Введение. Экосистема. Архитектура. Жизненный цикл Docker контейнера"

## Задача 1

Сценарий выполения задачи:

- создайте свой репозиторий на https://hub.docker.com;
- выберете любой образ, который содержит веб-сервер Nginx;
- создайте свой fork образа;
- реализуйте функциональность:
запуск веб-сервера в фоне с индекс-страницей, содержащей HTML-код ниже:
```
<html>
<head>
Hey, Netology
</head>
<body>
<h1>I’m DevOps Engineer!</h1>
</body>
</html>
```
Опубликуйте созданный форк в своем репозитории и предоставьте ответ в виде ссылки на https://hub.docker.com/username_repo.

Я взял официальный образ, посмотрев конфиги nginx в контейнере, увидел по какому пути находится html файл, который выводится на экран, затем его заменил своим, 
чтобы не писать новые конфиги, так быстрее.

```
docker exec -it hungry_lederberg nginx -V
docker exec -it hungry_lederberg cat /etc/nginx/nginx.conf
docker exec -it hungry_lederberg ls /etc/nginx/conf.d
docker exec -it hungry_lederberg cat /etc/nginx/conf.d/default.conf
```

[Dockerfile](src/build/nginx/Dockerfile)

Для сборки с проверкой локальной, исользуя dockerfile
```
docker build -t hitenok/nginx_fork:0.0.1 .
docker run -d -p 8080:80 hitenok/nginx_fork:0.0.1
curl localhost:8080
```

Для пуша
```
docker push hitenok/nginx_fork:0.0.1
```

Для проверки с закачкой из внешнего хранилища
```
docker rmi hitenok/nginx_fork:0.0.1
docker run -d -p 8080:80 hitenok/nginx_fork:0.0.1
curl localhost:8080
```

Ссылка на образ https://hub.docker.com/r/hitenok/nginx_fork

## Задача 2

Посмотрите на сценарий ниже и ответьте на вопрос:
"Подходит ли в этом сценарии использование Docker контейнеров или лучше подойдет виртуальная машина, физическая машина? Может быть возможны разные варианты?"

Детально опишите и обоснуйте свой выбор.

--

Сценарий:

- Высоконагруженное монолитное java веб-приложение;

Т.к. высокая нагрузка, значит для быстроты работы требуется меньше слоев, нужен прямой доступ к ресурсам, ещё и монолит,
а значит решение проблемы - физический сервер
- Nodejs веб-приложение;

Для web приложений докер подходит идеально, но БД обычно выносят вне его.
Хотя для develop, test, и в некоторых случаях даже для stage поднимают в докере.
- Мобильное приложение c версиями для Android и iOS;

Обычно backend отдельно, а мобильные приложения являются frontend-ом,
т.е. если хочется их поднимать, тестировать и прочее вне мобильных устройств, то 
можно воспользоваться и виртуальками с эмуляторами этих устройств.
- Шина данных на базе Apache Kafka;

Здесь как кто хочет, так и готовит, я так и не понял, как в идеале должно быть.

Для разных окружений могут использоваться разные способы.
В идеале для тестового всё глушить, вообще не используя кафку, 
но некоторые поднимают через докер, чтобы интеграционные тесты написать.

Некоторые используют песочницу как для тестов, так и для использования другими проектам.

У некоторых kafka одна на всю компанию, и все проекты используют её, через 
event collaboration. Но она для песочницы развернута, используя одни ресурсы, и для прода, используя другие, но 
стек разворачивания один и тот же, чтобы это было максимально приближено к prod.

Я думаю можно и виртуальку и докер.

- Elasticsearch кластер для реализации логирования продуктивного веб-приложения - три ноды elasticsearch, два logstash и две ноды kibana;

Я бы докер использовал, но можно и виртуальки.
- Мониторинг-стек на базе Prometheus и Grafana;

Как я понял это системы визуализации, т.е. они данные берут из хранилища, и отрисовывают, 
сами же их не хранят у себя. Значит можно и докер без проблем использовать.
- MongoDB, как основное хранилище данных для java-приложения;

С БД не работают через докер, обычно это отдельный физический сервер, проще доступы выдать dba и прочим ребятам, но, думаю, можно и на виртуальных машинах, 
с использованием хранения дубля данных.
- Gitlab сервер для реализации CI/CD процессов и приватный (закрытый) Docker Registry.

Как я понимаю, Gitlab имеет огромный функционал, интеграции и собственные реализации...можно некоторые части использовать прям в нем, а можно их вынести на отдельные 
сервера, и интегрировать работу с ними, чтобы не грузить основной сервер...

Сами runners для ci/cd использовать из других серверов, причем кластерно настроенные, 
тогда они будут одни для всех проектов.
Конфиги и образы можно хранить на облачном хранилище, тогда сам сервер развернуть через докер.


Если честно, то с некоторыми вещами я не работал лично, странно спрашивать то, с чем не имел дел, 
получается занялся исследованием, но как именно его проводить качественно на уроках не рассказывали, 
на что нужно операться, на что впервую очередь смотреть при выборе?

## Задача 3

- Запустите первый контейнер из образа ***centos*** c любым тэгом в фоновом режиме, подключив папку ```/data``` из текущей рабочей директории на хостовой машине в ```/data``` контейнера;
- Запустите второй контейнер из образа ***debian*** в фоновом режиме, подключив папку ```/data``` из текущей рабочей директории на хостовой машине в ```/data``` контейнера;
- Подключитесь к первому контейнеру с помощью ```docker exec``` и создайте текстовый файл любого содержания в ```/data```;
- Добавьте еще один файл в папку ```/data``` на хостовой машине;
- Подключитесь во второй контейнер и отобразите листинг и содержание файлов в ```/data``` контейнера.

## Задача 4 (*)

Воспроизвести практическую часть лекции самостоятельно.

Соберите Docker образ с Ansible, загрузите на Docker Hub и пришлите ссылку вместе с остальными ответами к задачам.
